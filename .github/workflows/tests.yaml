name: Chaos tests

env:
  WEAVIATE_VERSION: 1.19.6
  MINIMUM_WEAVIATE_VERSION: 1.15.0 # this is used as the start in the upgrade journey test
on:
  push
  
jobs:
  lint:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
      - uses: psf/black@stable
  import-with-kills-00:
    name: Import during constant kills/crashes
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - name: Polar Signals Continuous Profiling
        uses: polarsignals/gh-actions-ps-profiling@v0.0.1
        with:
          polarsignals_cloud_token: ${{ secrets.POLARSIGNALS_TOKEN }}
          labels: 'job=${{ github.job }};gh_run_id=${{ github.run_id }}'
      - name: Login to Docker Hub
        uses: docker/login-action@v2
        with:
          username: ${{secrets.DOCKER_USERNAME}}
          password: ${{secrets.DOCKER_PASSWORD}}
      - name: Run chaos test
        run: ./import_while_crashing.sh
  import-with-kills-01:
    name: Import during constant kills/crashes
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - name: Polar Signals Continuous Profiling
        uses: polarsignals/gh-actions-ps-profiling@v0.0.1
        with:
          polarsignals_cloud_token: ${{ secrets.POLARSIGNALS_TOKEN }}
          labels: 'job=${{ github.job }};gh_run_id=${{ github.run_id }}'
      - name: Login to Docker Hub
        uses: docker/login-action@v2
        with:
          username: ${{secrets.DOCKER_USERNAME}}
          password: ${{secrets.DOCKER_PASSWORD}}
      - name: Run chaos test
        run: ./import_while_crashing.sh
  import-with-kills-02:
    name: Import during constant kills/crashes
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - name: Polar Signals Continuous Profiling
        uses: polarsignals/gh-actions-ps-profiling@v0.0.1
        with:
          polarsignals_cloud_token: ${{ secrets.POLARSIGNALS_TOKEN }}
          labels: 'job=${{ github.job }};gh_run_id=${{ github.run_id }}'
      - name: Login to Docker Hub
        uses: docker/login-action@v2
        with:
          username: ${{secrets.DOCKER_USERNAME}}
          password: ${{secrets.DOCKER_PASSWORD}}
      - name: Run chaos test
        run: ./import_while_crashing.sh
  import-with-kills-02:
    name: Import during constant kills/crashes
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - name: Polar Signals Continuous Profiling
        uses: polarsignals/gh-actions-ps-profiling@v0.0.1
        with:
          polarsignals_cloud_token: ${{ secrets.POLARSIGNALS_TOKEN }}
          labels: 'job=${{ github.job }};gh_run_id=${{ github.run_id }}'
      - name: Login to Docker Hub
        uses: docker/login-action@v2
        with:
          username: ${{secrets.DOCKER_USERNAME}}
          password: ${{secrets.DOCKER_PASSWORD}}
      - name: Run chaos test
        run: ./import_while_crashing.sh
  import-with-kills-03:
    name: Import during constant kills/crashes
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - name: Polar Signals Continuous Profiling
        uses: polarsignals/gh-actions-ps-profiling@v0.0.1
        with:
          polarsignals_cloud_token: ${{ secrets.POLARSIGNALS_TOKEN }}
          labels: 'job=${{ github.job }};gh_run_id=${{ github.run_id }}'
      - name: Login to Docker Hub
        uses: docker/login-action@v2
        with:
          username: ${{secrets.DOCKER_USERNAME}}
          password: ${{secrets.DOCKER_PASSWORD}}
      - name: Run chaos test
        run: ./import_while_crashing.sh
  import-with-kills-04:
    name: Import during constant kills/crashes
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - name: Polar Signals Continuous Profiling
        uses: polarsignals/gh-actions-ps-profiling@v0.0.1
        with:
          polarsignals_cloud_token: ${{ secrets.POLARSIGNALS_TOKEN }}
          labels: 'job=${{ github.job }};gh_run_id=${{ github.run_id }}'
      - name: Login to Docker Hub
        uses: docker/login-action@v2
        with:
          username: ${{secrets.DOCKER_USERNAME}}
          password: ${{secrets.DOCKER_PASSWORD}}
      - name: Run chaos test
        run: ./import_while_crashing.sh
  import-with-kills-05:
    name: Import during constant kills/crashes
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - name: Polar Signals Continuous Profiling
        uses: polarsignals/gh-actions-ps-profiling@v0.0.1
        with:
          polarsignals_cloud_token: ${{ secrets.POLARSIGNALS_TOKEN }}
          labels: 'job=${{ github.job }};gh_run_id=${{ github.run_id }}'
      - name: Login to Docker Hub
        uses: docker/login-action@v2
        with:
          username: ${{secrets.DOCKER_USERNAME}}
          password: ${{secrets.DOCKER_PASSWORD}}
      - name: Run chaos test
        run: ./import_while_crashing.sh
  import-with-kills-06:
    name: Import during constant kills/crashes
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - name: Polar Signals Continuous Profiling
        uses: polarsignals/gh-actions-ps-profiling@v0.0.1
        with:
          polarsignals_cloud_token: ${{ secrets.POLARSIGNALS_TOKEN }}
          labels: 'job=${{ github.job }};gh_run_id=${{ github.run_id }}'
      - name: Login to Docker Hub
        uses: docker/login-action@v2
        with:
          username: ${{secrets.DOCKER_USERNAME}}
          password: ${{secrets.DOCKER_PASSWORD}}
      - name: Run chaos test
        run: ./import_while_crashing.sh
  import-with-kills-07:
    name: Import during constant kills/crashes
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - name: Polar Signals Continuous Profiling
        uses: polarsignals/gh-actions-ps-profiling@v0.0.1
        with:
          polarsignals_cloud_token: ${{ secrets.POLARSIGNALS_TOKEN }}
          labels: 'job=${{ github.job }};gh_run_id=${{ github.run_id }}'
      - name: Login to Docker Hub
        uses: docker/login-action@v2
        with:
          username: ${{secrets.DOCKER_USERNAME}}
          password: ${{secrets.DOCKER_PASSWORD}}
      - name: Run chaos test
        run: ./import_while_crashing.sh
  import-with-kills-08:
    name: Import during constant kills/crashes
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - name: Polar Signals Continuous Profiling
        uses: polarsignals/gh-actions-ps-profiling@v0.0.1
        with:
          polarsignals_cloud_token: ${{ secrets.POLARSIGNALS_TOKEN }}
          labels: 'job=${{ github.job }};gh_run_id=${{ github.run_id }}'
      - name: Login to Docker Hub
        uses: docker/login-action@v2
        with:
          username: ${{secrets.DOCKER_USERNAME}}
          password: ${{secrets.DOCKER_PASSWORD}}
      - name: Run chaos test
        run: ./import_while_crashing.sh
  import-with-kills-09:
    name: Import during constant kills/crashes
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - name: Polar Signals Continuous Profiling
        uses: polarsignals/gh-actions-ps-profiling@v0.0.1
        with:
          polarsignals_cloud_token: ${{ secrets.POLARSIGNALS_TOKEN }}
          labels: 'job=${{ github.job }};gh_run_id=${{ github.run_id }}'
      - name: Login to Docker Hub
        uses: docker/login-action@v2
        with:
          username: ${{secrets.DOCKER_USERNAME}}
          password: ${{secrets.DOCKER_PASSWORD}}
      - name: Run chaos test
        run: ./import_while_crashing.sh
  import-with-kills-10:
    name: Import during constant kills/crashes
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - name: Polar Signals Continuous Profiling
        uses: polarsignals/gh-actions-ps-profiling@v0.0.1
        with:
          polarsignals_cloud_token: ${{ secrets.POLARSIGNALS_TOKEN }}
          labels: 'job=${{ github.job }};gh_run_id=${{ github.run_id }}'
      - name: Login to Docker Hub
        uses: docker/login-action@v2
        with:
          username: ${{secrets.DOCKER_USERNAME}}
          password: ${{secrets.DOCKER_PASSWORD}}
      - name: Run chaos test
        run: ./import_while_crashing.sh
  import-with-kills-11:
    name: Import during constant kills/crashes
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - name: Polar Signals Continuous Profiling
        uses: polarsignals/gh-actions-ps-profiling@v0.0.1
        with:
          polarsignals_cloud_token: ${{ secrets.POLARSIGNALS_TOKEN }}
          labels: 'job=${{ github.job }};gh_run_id=${{ github.run_id }}'
      - name: Login to Docker Hub
        uses: docker/login-action@v2
        with:
          username: ${{secrets.DOCKER_USERNAME}}
          password: ${{secrets.DOCKER_PASSWORD}}
      - name: Run chaos test
        run: ./import_while_crashing.sh
  import-with-kills-12:
    name: Import during constant kills/crashes
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - name: Polar Signals Continuous Profiling
        uses: polarsignals/gh-actions-ps-profiling@v0.0.1
        with:
          polarsignals_cloud_token: ${{ secrets.POLARSIGNALS_TOKEN }}
          labels: 'job=${{ github.job }};gh_run_id=${{ github.run_id }}'
      - name: Login to Docker Hub
        uses: docker/login-action@v2
        with:
          username: ${{secrets.DOCKER_USERNAME}}
          password: ${{secrets.DOCKER_PASSWORD}}
      - name: Run chaos test
        run: ./import_while_crashing.sh
  import-with-kills-12:
    name: Import during constant kills/crashes
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - name: Polar Signals Continuous Profiling
        uses: polarsignals/gh-actions-ps-profiling@v0.0.1
        with:
          polarsignals_cloud_token: ${{ secrets.POLARSIGNALS_TOKEN }}
          labels: 'job=${{ github.job }};gh_run_id=${{ github.run_id }}'
      - name: Login to Docker Hub
        uses: docker/login-action@v2
        with:
          username: ${{secrets.DOCKER_USERNAME}}
          password: ${{secrets.DOCKER_PASSWORD}}
      - name: Run chaos test
        run: ./import_while_crashing.sh
  import-with-kills-13:
    name: Import during constant kills/crashes
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - name: Polar Signals Continuous Profiling
        uses: polarsignals/gh-actions-ps-profiling@v0.0.1
        with:
          polarsignals_cloud_token: ${{ secrets.POLARSIGNALS_TOKEN }}
          labels: 'job=${{ github.job }};gh_run_id=${{ github.run_id }}'
      - name: Login to Docker Hub
        uses: docker/login-action@v2
        with:
          username: ${{secrets.DOCKER_USERNAME}}
          password: ${{secrets.DOCKER_PASSWORD}}
      - name: Run chaos test
        run: ./import_while_crashing.sh
  import-with-kills-14:
    name: Import during constant kills/crashes
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - name: Polar Signals Continuous Profiling
        uses: polarsignals/gh-actions-ps-profiling@v0.0.1
        with:
          polarsignals_cloud_token: ${{ secrets.POLARSIGNALS_TOKEN }}
          labels: 'job=${{ github.job }};gh_run_id=${{ github.run_id }}'
      - name: Login to Docker Hub
        uses: docker/login-action@v2
        with:
          username: ${{secrets.DOCKER_USERNAME}}
          password: ${{secrets.DOCKER_PASSWORD}}
      - name: Run chaos test
        run: ./import_while_crashing.sh
  import-with-kills-15:
    name: Import during constant kills/crashes
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - name: Polar Signals Continuous Profiling
        uses: polarsignals/gh-actions-ps-profiling@v0.0.1
        with:
          polarsignals_cloud_token: ${{ secrets.POLARSIGNALS_TOKEN }}
          labels: 'job=${{ github.job }};gh_run_id=${{ github.run_id }}'
      - name: Login to Docker Hub
        uses: docker/login-action@v2
        with:
          username: ${{secrets.DOCKER_USERNAME}}
          password: ${{secrets.DOCKER_PASSWORD}}
      - name: Run chaos test
        run: ./import_while_crashing.sh
  import-with-kills-16:
    name: Import during constant kills/crashes
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - name: Polar Signals Continuous Profiling
        uses: polarsignals/gh-actions-ps-profiling@v0.0.1
        with:
          polarsignals_cloud_token: ${{ secrets.POLARSIGNALS_TOKEN }}
          labels: 'job=${{ github.job }};gh_run_id=${{ github.run_id }}'
      - name: Login to Docker Hub
        uses: docker/login-action@v2
        with:
          username: ${{secrets.DOCKER_USERNAME}}
          password: ${{secrets.DOCKER_PASSWORD}}
      - name: Run chaos test
        run: ./import_while_crashing.sh
  import-with-kills-17:
    name: Import during constant kills/crashes
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - name: Polar Signals Continuous Profiling
        uses: polarsignals/gh-actions-ps-profiling@v0.0.1
        with:
          polarsignals_cloud_token: ${{ secrets.POLARSIGNALS_TOKEN }}
          labels: 'job=${{ github.job }};gh_run_id=${{ github.run_id }}'
      - name: Login to Docker Hub
        uses: docker/login-action@v2
        with:
          username: ${{secrets.DOCKER_USERNAME}}
          password: ${{secrets.DOCKER_PASSWORD}}
      - name: Run chaos test
        run: ./import_while_crashing.sh
  import-with-kills-18:
    name: Import during constant kills/crashes
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - name: Polar Signals Continuous Profiling
        uses: polarsignals/gh-actions-ps-profiling@v0.0.1
        with:
          polarsignals_cloud_token: ${{ secrets.POLARSIGNALS_TOKEN }}
          labels: 'job=${{ github.job }};gh_run_id=${{ github.run_id }}'
      - name: Login to Docker Hub
        uses: docker/login-action@v2
        with:
          username: ${{secrets.DOCKER_USERNAME}}
          password: ${{secrets.DOCKER_PASSWORD}}
      - name: Run chaos test
        run: ./import_while_crashing.sh
  import-with-kills-19:
    name: Import during constant kills/crashes
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - name: Polar Signals Continuous Profiling
        uses: polarsignals/gh-actions-ps-profiling@v0.0.1
        with:
          polarsignals_cloud_token: ${{ secrets.POLARSIGNALS_TOKEN }}
          labels: 'job=${{ github.job }};gh_run_id=${{ github.run_id }}'
      - name: Login to Docker Hub
        uses: docker/login-action@v2
        with:
          username: ${{secrets.DOCKER_USERNAME}}
          password: ${{secrets.DOCKER_PASSWORD}}
      - name: Run chaos test
        run: ./import_while_crashing.sh
